{% extends "base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<link rel="stylesheet" href="{% static 'css/mensagens/caixa_entrada.css' %}">

<div class="inbox-wrapper">
  <div class="inbox-container">
    <div class="inbox-header">
      ðŸ“¬ Caixa de Entrada
    </div>

    <div class="list-group list-group-flush">
      {% for conversa in conversas %}
      <a href="{% url 'mensagens:conversa' conversa.outro_username %}" class="conversation-item list-group-item-action">
        <div class="d-flex align-items-center">
          {% if conversa.outro_foto %}
            <img src="{{ conversa.outro_foto }}" alt="Foto de {{ conversa.outro_username }}" class="profile-pic-sm me-3">
          {% else %}
            <i class="fas fa-user-circle fa-3x text-primary me-3"></i>
          {% endif %}

          <div class="conversation-info">
            <strong>{{ conversa.outro_username }}</strong>
            <small>{{ conversa.total }} mensagens â€” {{ conversa.ultima_data|date:"d/m/Y H:i" }}</small>
          </div>
        </div>

        {% if conversa.nao_lidas > 0 %}
          <span class="badge">{{ conversa.nao_lidas }} nova(s)</span>
        {% endif %}
      </a>
      {% empty %}
      <div class="no-conversations">
        VocÃª ainda nÃ£o tem conversas ðŸ˜…
      </div>
      {% endfor %}
    </div>

    <div class="send-btn-wrapper">
      <a href="{% url 'mensagens:enviar_mensagem_geral' %}" class="send-btn">
        <i class="fa-solid fa-paper-plane me-2"></i>Enviar para seguidore
      </a>
    </div>
  </div>
</div>

<!-- Clique animado -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(function () {
    $(".conversation-item").on("click", function () {
      $(this).addClass("active-conv");
      setTimeout(() => $(this).removeClass("active-conv"), 200);
    });
  });
</script>
{% endblock %}
